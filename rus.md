# Частичное применение в JavaScript с помощью `bind()`

В JavaScript есть паттерн, который, как я считаю, используется намного реже чем 
стоило бы, ведь он даёт более лаконичный код, который проще писать и читать. Вы 
все наверное слышали о [Function.prototype.bind][1]. В большинстве случаев он 
используется когда нужно избавиться от присваиваний вроде `var that = this` или 
`var self = this`, встречающихся на каждом шагу. Вот простой пример:

    this.setup = function () {
       this.on('event', this.handleEvent.bind(this));
    };

Первый аргумент переданный методу `bind` служит в качестве `this` в рамках 
функции, которую возвращает `bind`. Менее известным качеством `bind` является то, 
что он принимает более одного параметра. *Каждый параметр `bind` после первого 
добавляется в начало списка параметров при вызове привязанной функции.*

Это значит, что мы можем создать частично примененные функции такого вида:

    var add = function (a, b) {
      return a + b;
    };
    var add2 = add.bind(null, 2);

    add2(10) === 12;

Увлекательно, правда? Область применения будет более очевидной если немного 
расширить изначальный пример обработки события. Ещё один популярный паттерн при 
обработке событий — добавление какого-то контента при вызове обработчика:

    this.setup = function () {
      this.on('tweet', function (e, data) {
        this.handleStreamEvent('tweet', e, data);
      }.bind(this));
      this.on('retweet', function (e, data) {
        this.handleStreamEvent('retweet', e, data);
      }.bind(this));
    };

Если обработчики событий для `tweet` и `retweet` используют большую порцию общей 
логики, хорошей идеей будет структурировать код таким образом. Однако, налицо и 
побочные эффекты. Например, большое количество шаблонного кода. В обеих случаях 
придётся создать анонимную функцию, вызвать в ней обработчик события, передать 
параметры и не забыть привязать функцию так, чтобы контекст `this` был 
установлен должным образом. 

А нельзя ли это сделать как-то проще? Можно конечно!

    this.setup = function () {
      this.on('tweet', this.handleStreamEvent.bind(this, 'tweet'));
      this.on('retweet', this.handleStreamEvent.bind(this, 'retweet'));
    };

Красота, не правда ли? Итак, что здесь произошло? Вместо того, чтобы вызывать 
функцию в анонимной обёртке, мы создали две частично применённые функции, 
которые принимают контекст `this` и два разных первых параметра каждая. `e` и 
`data` будут переданы без нашего вмешательства. 

Если вы похожи на меня несколько месяцев назад, в данный момент у вас глаза 
вылезли на лоб от шока и вы отправились подчищать свой код от всех подобных 
явлений. Когда закончите, не забудьте поделиться с друзьями.

[1]: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/bind